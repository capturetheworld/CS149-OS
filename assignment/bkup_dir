
#include "util.h"

/** Instruction: Assignment 5: complie like "gcc -o  forpipe
 * Please note I have used a util.h as header file
 * 1)use getline to read a command line option 48,54 , check for user error like no input 
 * 1a) Convert the string to long long
 * 2) put it in a long long array long long data[MAX}
 * 3) use fork() to start 2 processes: parent and child 
 * 4) check pid<0; pid==0 means child ; pid>0 meand parent process 
 * 5) fd[0] where the index 0 stands for reading pipe
 * 6) fd[1] where the index 1 stands for writing pipe
 * 7) In child process  write a function with argument like void addOne(long long l_input],long long l_output[]) to loop thru data array and increment each value by 1.  Call the function with addOne(data,result); * store the new value in  long long result[MAX];
 *
 * 8)write(port, input, size) to write into the pipe. port refers to fd[1], input refers to in your case  reslut[], size is sizeof(data)
 * 9) In parent process read pipe by read(read_port, input, size). In your program, create a new long long data_read[MAX] as input,
 * read_port is fd[0], size is sizeof(data_read);
 * 10) print out the array data_read. It should have the data from nums  incremented by 1. So if nums has 12 the data_read should have 13 etc.
 * */




#include "util.h"

/** Instruction: Assignment 4: complie like "gcc -o strptr.c strptr
 * Please note I have used a util.h as header file
 * 1)If you are successful with either assignment 1 or 2 or better yet use both if both are successful as input
 * 2) use getline to read a command line "< nums , check for user error like no input 
 * 3) store them in a str ptr array
 * 4) create a function called printLLArray(long long input[MAX]) to print out the input array passed to it by 
 * using either while loop or for loop.
 * */
#include "util.h"

/** Instruction: Assignment 4: complie like "gcc -o luluptr.c luluptr
 * Please note I have used a util.h as header file
 * 1)If you are successful with either assignment 1 or 2 or better yet use both if both are successful as input
 * 2) use getline to read a command line "< nums , check for user error like no input 
 * 3) store them in a str ptr array
 * 4) create a function called printLLArray(long long input[MAX]) to print out the input array passed to it by 
 * using either while loop or for loop.
 * */

void storeLuluArray(long long l_input [], long long l_out[]){

}



#include "util.h"



 long long  firstfactors[MAX];
 long long  finalfactors[MAX];
 int final_iterator =0;
 int first_iterator =0;
 long long prime[MAX] ={2,3, 5, 7, 9, 11, 13};


	long long child1_array[MAX];	
	long long child2_array[MAX];	
	long long child3_array[MAX];	

		
int main(int argc, char * argv[]) {

	char *pointers;
	char *pointers_array[MAX];
	int fd1[2], fd2[2], fd3[2], fd4[2];

	size_t buf_sz =32;
//	size_t memory_read;
	int count=0;
	int index=1;
//	char * pointers_index;

	printf("argc is %d\n",argc);

	if (argc ==1) {
	pointers = (char *)malloc(buf_sz * sizeof(char));
	if (pointers == NULL){
		printf("Unable to allocate memory");
		exit(1);
	}

	
	while (( getline(&pointers, &buf_sz, stdin)) != -1){

		pointers_array[count] = pointers;
		count++;
		pointers++;
	pointers = (char *)malloc(buf_sz * sizeof(char));
	}
		pointers_array[count] = NULL;
	} // finish reading the data iniput file thru <
	else{

		printf("argc is %d",argc);
		while (index < argc) {
		pointers_array[count] = argv[index];
		count++;
		printf("argv index %d is %s\n", index, argv[index]);
		index++;
		pointers_array[count] = NULL;
		}
	}
	long long factor_smaller_parent[MAX];
	long long factor_smaller_child1[MAX];
	long long factor_smaller_child2[MAX];
	long long factor_bigger_parent[MAX];
	long long factor_bigger_child1[MAX];
	long long factor_bigger_child2[MAX];
	long long input;
	
	input = 9412132121238; // teacher 's test
	input = 94121324123883888; // a good number to factor upper bound is 44538
	input = 542649999999999998; // boundary exceeded
	input = 9412132121238; // teacher 's test
	input = 48;
	long long bound_range [3];
	long long lower_bound, upper_bound;


    for (int i = 0; i < count; i++) //loop through each element

    {
    	char * invalid;

	startPipe(fd1,fd2,fd3,fd4);



	getTriRanges(input, bound_range) ;


	input = strtol(pointers_array[i],&invalid,10);

      printf("\nThe input after strtol is %llu\n", input);
        

    	if (input <= 0) {
    		printf("%s\n", "Error, only enter numbers and positive numbers greater than 0.");
    		exit(0);
    	}

    	fflush(stdin);

    	int pid = fork();

    	if (pid < 0) {
    		printf("%s\n", "Couldn't split processes");
    		exit(-1);

    	}
	else if (pid ==0) { // first child
// first child process


	lower_bound =bound_range[0] +1;
	upper_bound =bound_range[1];
	getFactors(input,factor_smaller_child1, factor_bigger_child1,lower_bound,upper_bound);

	combineSmallBig(factor_smaller_child1,factor_bigger_child1);


//        fillChild(child1_array);	
//        /*
/*	int size = sizeof(child1_array);
	printLLArray(child1_array,"\nChildArray in child process has");
	*/

int size = sizeof(factor_smaller_child1);
	 writeToPipe(factor_smaller_child1, fd2[1],size);


          	//firstRangeFactors(input); 
          }
    	else if (pid > 0) { //parent  starting another process

		int pid2 = fork();

		if (pid2 == 0){  // 2nd child
// 2nd child process





	lower_bound =bound_range[1] +1;
	upper_bound =bound_range[2];
	getFactors(input,factor_smaller_child2, factor_bigger_child2,lower_bound,upper_bound);
	combineSmallBig(factor_smaller_child2,factor_bigger_child2);


int size = sizeof(factor_smaller_child2);
	 writeToPipe(factor_smaller_child2,fd4[1],size);
	 //close(fd4[1]);

          }

	   else { 
// parent 

 		long long child_obtained[MAX];


		lower_bound =2;
		upper_bound =bound_range[0];
		getFactors(input,factor_smaller_parent, factor_bigger_parent,lower_bound,upper_bound);


		wait(NULL);
// read from first child

 		int size = sizeof(child_obtained);
	 		readFromPipe(child_obtained, fd2[0], size);
	 		extractArray(factor_smaller_parent, factor_bigger_parent,child_obtained);

//printLLArray(child_obtained,"\n***Child_obtained has");

// read from 2nd child
// debug
// /
  		size = sizeof(child_obtained);
	 		readFromPipe(child_obtained, fd4[0], size);

	 extractArray(factor_smaller_parent, factor_bigger_parent,child_obtained);
printLLArray(factor_smaller_parent,"\n++++factor_smaller_parent");
printLLArray(factor_bigger_parent,"\n++++factor_bigger_parent");

          }


      }

 }
}

#include "util.h"

/** Instruction: Assignment 1: complie like "gcc -o playargc playargc.c
 * Please note I have used a util.h as header file
 * 1)use getline to read a command line option 48,54 , print out the argc value 
 * 2)use getline to read a command line option < nums , print out the argc value 
 * 3) use the different value to decide what input format user chooses
 * 4) print out the option choice user chose as "48 54" or "< nums" 
 *
 * */

#include "util.h"

/** Instruction: Assignment 4: complie like "gcc -o ptr.c ptr
 * Please note I have used a util.h as header file
 * 1)If you are successful with either assignment 1 or 2 or better yet use both if both are successful as input
 * 2) use getline to read a command line "< nums , check for user error like no input 
 * 3) store them in a str ptr array
 * 4) create a function called printStrArray() to print out the input array of strings passed to it by 
 * 4) create a function called printLLArray() to print out the input array of long long passed to it by 
 * using either while loop or for loop. Use strtol() in your main function to convert the input string to long long before
 * calling printLLArray()
 * */

void printStrArray( testArray, char *des)  // what type should testArray be if it refers to an array of strings? 


void printLLArray(testArray, char * des) // what type should testArray be if it refers to an array of long long? 
		) 


#include "util.h"

/** Instruction: Assignment 2: complie like "gcc -o readcat readcat.c
 * Please note I have used a util.h as header file
 * 1)use getline to read a command line "< nums , check for user error like no input 
 * 1a) Convert the string to long long
 * 2) put it in a long long array
 * 3) add 1 to each input
 * 4) printf the result to stdout
 *
 * */

#include "util.h"

/** Instruction: Assignment 1a: complie like "gcc -o readcmd readcmd
 * Please note I have used a util.h as header file
 * 1)use getline to read a command line option 48,54 , check for user error like no input 
 * 1a) Convert the string to long long
 * 2) put it in a long long array
 * 3) add 1 to each input
 * 4) printf the result to stdout
 *
 * */

